<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SWDSMS Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root {
  --light-blue: #C3E7F1;
  --moonstone: #519CAB;
  --saffron: #FFC64F;
  --gunmetal: #20373B;
  --white: #ffffff;
}

* {
  box-sizing: border-box;
  font-family: 'Segoe UI', sans-serif;
}

body {
  margin: 0;
  background: var(--light-blue);
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}

/* ===== TOP NAVBAR ===== */
.topbar {
  height: 70px;
  background: var(--gunmetal);
  color: white;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 30px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.15);
}

.brand {
  display: flex;
  align-items: center;
  gap: 12px;
  font-size: 22px;
  font-weight: 700;
}

.brand img {
  width: 38px;
  height: 38px;
  border-radius: 50%;
  background: white;
  padding: 4px;
}

.logout-btn {
  background: var(--moonstone);
  border: none;
  padding: 10px 22px;
  color: white;
  border-radius: 8px;
  cursor: pointer;
  font-weight: 600;
  transition: 0.3s;
}

.logout-btn:hover {
  background: #3f8896;
}

/* USER AREA */
.user-area{
  display:flex;
  align-items:center;
  gap:18px;
}

.user-info{
  display:flex;
  align-items:center;
  gap:10px;
  background:rgba(255,255,255,0.12);
  padding:8px 14px;
  border-radius:20px;
  font-weight:600;
  font-size:14px;
}

.user-info img{
  width:28px;
  height:28px;
  border-radius:50%;
  background:white;
  padding:4px;
}

/* ===== LAYOUT ===== */
.layout {
  display: flex;
  flex: 1;
}

/* ===== SIDEBAR ===== */
.sidebar {
  width: 240px;
  background: var(--gunmetal);
  color: white;
  padding-top: 30px;
  display: flex;
  flex-direction: column;
}

.sidebar a {
  text-decoration: none;
  color: white;
  padding: 14px 25px;
  font-size: 15px;
  display: block;
  transition: 0.3s;
  border-left: 4px solid transparent;
}

.sidebar a:hover {
  background: rgba(255,255,255,0.08);
  border-left: 4px solid var(--saffron);
}

.sidebar a.active {
  background: rgba(255,255,255,0.12);
  border-left: 4px solid var(--saffron);
  font-weight: 600;
}

/* ===== CONTENT ===== */
.content {
  flex: 1;
  background: var(--light-blue);
  display: flex;
  justify-content: center;
  padding: 40px 20px;
}

.page-container {
  width: 100%;
  max-width: 1050px;
}

/* ===== CARD ===== */
.dashboard-card {
  background: var(--white);
  border-radius: 18px;
  padding: 35px;
  box-shadow: 0 10px 25px rgba(0,0,0,0.08);
  width: 100%;
}

.dashboard-title {
  color: var(--gunmetal);
  margin-top: 0;
}

/* ===== STATS ===== */
.stats {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 20px;
  margin-top: 25px;
}

.stat-box {
  background: var(--light-blue);
  border-radius: 14px;
  padding: 22px;
  box-shadow: inset 0 0 0 1px rgba(0,0,0,0.05);
  transition: 0.3s;
}

.stat-box:hover {
  transform: translateY(-4px);
  box-shadow: 0 6px 15px rgba(0,0,0,0.1);
}

.stat-box h3 {
  margin: 0;
  font-size: 15px;
  color: var(--gunmetal);
  font-weight: 600;
}

.stat-box p {
  font-size: 28px;
  font-weight: 700;
  margin-top: 10px;
  color: var(--gunmetal);
}

.stat-link{
  text-decoration:none;
}
</style>
</head>

<body>

<!-- TOP BAR -->
<div class="topbar">
  <div class="brand">
    <img src="logo.png" alt="Logo">
    SWDSMS
  </div>

  <div class="user-area">
    <div class="user-info">
      <img src="user-icon.jpg" alt="user">
      <span>Administrator</span>
    </div>
    <button class="logout-btn" onclick="logout()">Logout</button>
  </div>
</div>

<div class="layout">

<!-- SIDEBAR -->
<div class="sidebar">
  <a href="#" class="active">Dashboard</a>
  <a href="incident-list.html">Incident List/Table</a>
</div>

<!-- CONTENT -->
<div class="content">
<div class="page-container">

<div class="dashboard-card">
<h2 class="dashboard-title">Dashboard Overview</h2>

<div class="stats">

<a href="#" class="stat-link">
  <div class="stat-box">
    <h3>Total Incidents</h3>
    <p id="totalCount">0</p>
  </div>
</a>

<a href="#" class="stat-link">
  <div class="stat-box">
    <h3>Bullying</h3>
    <p id="bullyingCount">0</p>
  </div>
</a>

<a href="#" class="stat-link">
  <div class="stat-box">
    <h3>Language</h3>
    <p id="languageCount">0</p>
  </div>
</a>

<a href="#" class="stat-link">
  <div class="stat-box">
    <h3>Digital Misuse</h3>
    <p id="digitalCount">0</p>
  </div>
</a>


</div>
</div>

</div>
</div>

</div>

<script>
/* ===== ZERO DATA ENGINE (NO LOGIC FLOW CHANGE) ===== */

document.addEventListener("DOMContentLoaded", async () => {
  const totalEl = document.getElementById("totalCount");
  const bullyingEl = document.getElementById("bullyingCount");
  const languageEl = document.getElementById("languageCount");
  const digitalEl = document.getElementById("digitalCount");

  // set loading state
  totalEl.textContent = '—';
  bullyingEl.textContent = '—';
  languageEl.textContent = '—';
  digitalEl.textContent = '—';

  try{
    const res = await fetch('/api/reports');
    if(!res.ok) throw new Error('Failed to load reports');
    const reports = await res.json();

    const total = reports.length;
    const bullying = reports.filter(r => (r.type || r.Type || '').toLowerCase() === 'bullying').length;
    const language = reports.filter(r => (r.type || r.Type || '').toLowerCase() === 'language').length;
    const digital = reports.filter(r => (r.type || r.Type || '').toLowerCase() === 'digital misuse').length;

    totalEl.textContent = total;
    bullyingEl.textContent = bullying;
    languageEl.textContent = language;
    digitalEl.textContent = digital;
  }catch(err){
    console.error(err);
    // fall back to zeros on error
    totalEl.textContent = 0;
    bullyingEl.textContent = 0;
    languageEl.textContent = 0;
    digitalEl.textContent = 0;
  }
});

/* LOGOUT */
function logout(){
  window.location.href = "login.html";
}
</script>

</body>
</html>
